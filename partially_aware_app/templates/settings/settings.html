{% extends "template_parts/base.html" %}

{% block content %}
<main class="flex-1 p-4 sm:p-6 lg:p-8 mt-4">
	<div class="bg-white p-6 rounded shadow">
		<div class="flex justify-between flex-wrap items-center pb-3">
			<h1 class="text-2xl font-semibold text-gray-900">Settings</h1>
		</div>
		<hr class="my-4 border-gray-300"/>

		<div class="mb-4 border-b border-gray-200 border-gray-700">
			<ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="default-tab" data-tabs-toggle="#default-tab-content" role="tablist">
				<li class="me-2" role="presentation">
					<button
						class="inline-block p-4 border-b-2 rounded-t-lg {% if active_tab == 'profile' %}border-blue-500 text-blue-600{% else %}hover:text-gray-600{% endif %}"
						id="profile-tab" data-tabs-target="#profile" type="button" role="tab"
						aria-controls="profile" aria-selected="{{ 'true' if active_tab == 'profile' else 'false' }}">
						Profile
					</button>
				</li>
				<li class="me-2" role="presentation">
					<button
						class="inline-block p-4 border-b-2 rounded-t-lg {% if active_tab == 'agent' %}border-blue-500 text-blue-600{% else %}hover:text-gray-600{% endif %}"
						id="agent-tab" data-tabs-target="#agent" type="button" role="tab"
						aria-controls="profile" aria-selected="{{ 'true' if active_tab == 'agent' else 'false' }}">
						Agent
					</button>
				</li>
			</ul>
		</div>
		<div id="default-tab-content">
			<div class="{% if active_tab == 'profile' %}block{% else %}hidden{% endif %} p-4 rounded-lg bg-gray-50 bg-gray-800" id="profile" role="tabpanel" aria-labelledby="profile-tab">
				<p class="text-sm text-gray-500 text-gray-400">This is some placeholder content the <strong class="font-medium text-gray-800 text-white">Profile tab's associated content</strong>. Clicking another tab will toggle the visibility of this one for the next. The tab JavaScript swaps classes to control the content visibility and styling.</p>
			</div>
			<div class="{% if active_tab == 'agent' %}block{% else %}hidden{% endif %} p-4 rounded-lg bg-gray-50 bg-gray-800" id="agent" role="tabpanel" aria-labelledby="agent-tab">
				<div class="overflow-x-auto">
					<table class="min-w-full divide-y divide-gray-200">
						<thead class="bg-gray-50">
							<tr>
								<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
								<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
								<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL</th>
								<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created by</th>
								<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
							</tr>
						</thead>
						<tbody class="bg-white divide-y divide-gray-200">
							{% for agent in agents %}
							<tr>
								<td class="px-4 py-2 whitespace-nowrap">{{ agent.id }}</td>
								<td class="px-4 py-2 whitespace-nowrap">{{ agent.name }}</td>
								<td class="px-4 py-2 whitespace-nowrap">{{ agent.url }}</td>
								<td class="px-4 py-2 whitespace-nowrap">{{ agent.user_id }}</td>
								<td class="px-4 py-2 whitespace-nowrap">
									<a href="{{ url_for('settings.edit_agent', id=agent.id) }}" class="px-3 py-1 text-sm border border-blue-500 text-blue-600 rounded hover:bg-blue-50">View</a>
								</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>

					<form method="POST" class="w-full" action="{{ url_for('settings.create_agent') }}" }}>
						{{ agent_form.hidden_tag() }}

						<div class="flex items-center py-2 gap-4 w-full border-b border-gray-500">
							<div class="flex-1 flex flex-col">
								{{ agent_form.name(
									class="appearance-none bg-transparent border-none
										text-gray-200 placeholder-gray-400 py-1 px-2 leading-tight
										focus:outline-none focus:text-white",
									placeholder="Name"
								) }}
								<p class="text-red-600 text-sm h-5 mt-1">
									{% for error in agent_form.name.errors %}
										{{ error }}
									{% endfor %}
								</p>
							</div>

							<div class="flex-1 flex flex-col">
								{{ agent_form.url(
									class="appearance-none bg-transparent border-none
										text-gray-200 placeholder-gray-400 py-1 px-2 leading-tight
										focus:outline-none focus:text-white",
									placeholder="URL"
								) }}
								<p class="text-red-600 text-sm h-5 mt-1">
									{% for error in agent_form.url.errors %}
										{{ error }}
									{% endfor %}
								</p>
							</div>

							<button
								type="submit"
								class="flex-shrink-0 whitespace-nowrap inline-flex items-center
									px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
								{{ agent_form.submit.label.text }}
							</button>
						</div>
					</form>

				</div>
			</div>
		</div>
	</div>
</main>
{% endblock %}
